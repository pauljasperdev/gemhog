---
phase: 01-testing-infrastructure
plan: 07
type: execute
wave: 1
depends_on: []
files_modified:
  - apps/web/src/app/ai/page.tsx
  - apps/web/src/app/dashboard/dashboard.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "pnpm check passes without lint warnings in apps/web"
    - "Biome useExhaustiveDependencies warning is resolved"
    - "Biome noNonNullAssertion warning is resolved"
    - "Biome noUnusedFunctionParameters warning is resolved"
  artifacts:
    - path: "apps/web/src/app/ai/page.tsx"
      provides: "AI chat page without lint warnings"
      contains: "useEffect"
    - path: "apps/web/src/app/dashboard/dashboard.tsx"
      provides: "Dashboard component without lint warnings"
      contains: "hasProSubscription"
  key_links:
    - from: "apps/web/src/app/ai/page.tsx"
      to: "useEffect"
      via: "correct dependency array"
      pattern: "useEffect.*\\[\\]|useEffect.*messagesEndRef"
---

<objective>
Fix pre-existing Biome lint warnings in apps/web that cause `pnpm check` to exit non-zero.

Purpose: Unblock CI and pre-commit hooks by resolving lint errors.
Output: Clean lint pass for apps/web components.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/phases/01-testing-infrastructure/01-VERIFICATION.md

Reference files with issues:
@apps/web/src/app/ai/page.tsx
@apps/web/src/app/dashboard/dashboard.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Fix lint warnings in ai/page.tsx</name>
  <files>apps/web/src/app/ai/page.tsx</files>
  <action>
Fix the `useExhaustiveDependencies` warning on line 23-25.

The current code:
```tsx
useEffect(() => {
  messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
}, [messages]);
```

The issue: Biome says `messages` is not actually used inside the effect - the effect only uses `messagesEndRef.current`. However, the INTENT is clearly to scroll when messages change.

Fix approach: Keep `messages` in the dependency array because the scroll behavior SHOULD run when messages change. The ref itself won't trigger re-renders. To satisfy Biome while preserving the intended behavior, add `messages.length` to make the dependency explicit:

```tsx
useEffect(() => {
  messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
}, [messages.length]);
```

This tells Biome "yes, I depend on messages changing" while being more specific about what aspect of messages triggers the effect.
  </action>
  <verify>Run `pnpm check 2>&1 | grep ai/page.tsx` - should return no output (no warnings)</verify>
  <done>No Biome warnings in apps/web/src/app/ai/page.tsx</done>
</task>

<task type="auto">
  <name>Task 2: Fix lint warnings in dashboard.tsx</name>
  <files>apps/web/src/app/dashboard/dashboard.tsx</files>
  <action>
Fix two Biome warnings:

1. **noNonNullAssertion (line 17):**
   Current: `customerState?.activeSubscriptions?.length! > 0`
   Issue: Non-null assertion (`!`) after optional chaining is unsafe.
   Fix: Use nullish coalescing or proper null check:
   ```tsx
   const hasProSubscription = (customerState?.activeSubscriptions?.length ?? 0) > 0;
   ```

2. **noUnusedFunctionParameters (line 10):**
   Current: `session` parameter is declared but never used in the component.
   Options:
   - Remove the parameter if not needed
   - Prefix with underscore: `_session` to indicate intentionally unused
   - Use the parameter somewhere

   Check if `session` is passed by the parent and might be needed for future use. If it's scaffolding for future work, prefix with underscore. If truly unnecessary, remove it.

   Looking at the component, `session` appears to be passed from the parent page but isn't used - the component uses `customerState` for subscription info. Prefix with underscore to indicate intentionally unused (may be needed for future auth checks):
   ```tsx
   export default function Dashboard({
     customerState,
     _session,
   }: {
     customerState: ReturnType<typeof authClient.customer.state>;
     _session: typeof authClient.$Infer.Session;
   }) {
   ```
  </action>
  <verify>Run `pnpm check 2>&1 | grep dashboard.tsx` - should return no output (no warnings)</verify>
  <done>No Biome warnings in apps/web/src/app/dashboard/dashboard.tsx</done>
</task>

</tasks>

<verification>
Run full lint check to confirm all warnings are resolved:
```bash
pnpm check
```
Should exit with code 0 (no warnings, no errors).
</verification>

<success_criteria>
- `pnpm check` exits with code 0
- No Biome warnings in apps/web/src/app/ai/page.tsx
- No Biome warnings in apps/web/src/app/dashboard/dashboard.tsx
</success_criteria>

<output>
After completion, create `.planning/phases/01-testing-infrastructure/01-07-SUMMARY.md`
</output>
