---
phase: 03.1-code-review-fixes
plan: 02
subsystem: payments
tags: [effect, polar, cleanup, dead-code]

# Dependency graph
requires:
  - phase: 03-core-consolidation
    provides: payment domain with PaymentService, PaymentLive, polarClient
provides:
  - Removed dead payment service code (not used anywhere)
  - Simplified @gemhog/core exports (removed ./payment subpath)
affects: []

# Tech tracking
tech-stack:
  added: []
  patterns: []

key-files:
  created: []
  modified:
    - packages/core/package.json

key-decisions:
  - "Delete entire payment/ directory since no exports were used externally"
  - "Keep @polar-sh/sdk as auth.service.ts uses it inline"

patterns-established: []

# Metrics
duration: 3min
completed: 2026-01-21
---

# Phase 3.1 Plan 02: Remove Dead Payment Service Code Summary

**Deleted unused PaymentService, PaymentLive, polarClient exports - Polar integration is handled inline in auth.service.ts via better-auth plugin**

## Performance

- **Duration:** 3 min
- **Started:** 2026-01-21T08:59:12Z
- **Completed:** 2026-01-21T09:02:14Z
- **Tasks:** 2
- **Files modified:** 1 (packages/core/package.json)
- **Files deleted:** 5 (entire payment/ directory)

## Accomplishments

- Removed dead payment service code (PaymentService, PaymentLive, polarClient, getPolarClient)
- Deleted entire packages/core/src/payment/ directory
- Removed ./payment subpath export from package.json
- Verified no broken imports (types pass, unit tests pass)

## Task Commits

Each task was committed atomically:

1. **Task 1: Remove dead payment service files** - `8be5567` (chore)
2. **Task 2: Verify no broken imports** - (verification only, no commit needed)

## Files Created/Modified

**Deleted:**
- `packages/core/src/payment/payment.service.ts` - Dead PaymentService/PaymentLive code
- `packages/core/src/payment/payment.mock.ts` - Unused mock layer
- `packages/core/src/payment/payment.test.ts` - Tests for dead code
- `packages/core/src/payment/payment.errors.ts` - Unused error types
- `packages/core/src/payment/index.ts` - Barrel export for dead module

**Modified:**
- `packages/core/package.json` - Removed ./payment subpath export

## Decisions Made

1. **Delete entire payment/ directory** - All exports (PaymentService, PaymentLive, polarClient, getPolarClient, PaymentError) were unused. No reason to keep an empty module.

2. **Keep @polar-sh/sdk dependency** - Although the payment module was deleted, auth.service.ts still uses `@polar-sh/sdk` to create a Polar client inline for the better-auth plugin.

## Deviations from Plan

None - plan executed exactly as written.

## Issues Encountered

1. **Git staging issue** - Initial commit only included package.json change, not the file deletions. The pre-commit hook restored the working directory state. Fixed by amending the commit to include all deleted files.

## User Setup Required

None - no external service configuration required.

## Next Phase Readiness

- Payment service dead code removed
- @gemhog/core is cleaner with only actively used exports
- Ready for remaining code review fixes (03.1-01, 03.1-03+)

---
*Phase: 03.1-code-review-fixes*
*Completed: 2026-01-21*
